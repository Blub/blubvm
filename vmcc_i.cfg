set _ver_vmcc 1

set _cc_func nop

// for unknown code, move one param into eax and return
alias _cc_return "set eax \"$1\""

alias __cc_dofunc "$_cc_func ${* asis}"

// check for an adding operation
alias _cc_addop "mov _cc_func \"$2\"; toggle _cc_func _cc_return + __cc_addop; __cc_dofunc ${* asis}"
// adding stuff is done with the overcool rpn calculator
// put return value in eax
// a + b, first execute b
alias __cc_addop "cc ${3- asis} _ _; __cc_addop2 $1"
alias __cc_addop2 "menu_cmd rpn /eax $1 eax + def"

// check for an assignment operation
alias _cc_assign "mov _cc_func \"$2\"; toggle _cc_func _cc_addop = __cc_assign; __cc_dofunc ${* asis}"
// if an assignment has been found execute it by first executing the right operand
// then assigning it to the left operand
// `cc right` returns in eax
alias __cc_assign "cc ${3- asis} _ _; __cc_assign_return $1"
// keep return value in eax
alias __cc_assign_return "mov $1 $eax"

alias cc "_cc_assign ${* asis}"
